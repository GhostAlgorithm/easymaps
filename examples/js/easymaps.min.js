function EasyMap(t){this.map_el=document.getElementById(t.container),this.map_obj=null,this.info_window_system=null!=t.infoWindowSystem?t.infoWindowSystem:EasyMap.InfoWindowSystem.ONE_WINDOW,this.map_markers=[],this.map_lines=[],this.map_shapes=[],this.marker_res={},this.synced_maps=[],this.logo_div,this.logo_img,this.coordinates_div=document.createElement("div"),this.coordinates_div.setAttribute("style","width: 200px; height: 20px; background-color: #FFFFFF; border-style: solid; border-width: 1px; padding: 2px 5px;"),this.coordinates_div.innerHTML="Lat/Lng: 0.00 / 0.00",this.coordinates_shown=!1,this.default_line_props=new EasyLineProperties({}),this.current_maptypeid=null!=t.mapTypeId?t.mapTypeId:google.maps.MapTypeId.ROADMAP,this.infoWindow=null,this.marker_callback=null,this.map_options={center:new google.maps.LatLng(t.latitude,t.longitude),zoom:null!=t.zoom?t.zoom:15,mapTypeId:this.current_maptypeid},this.map_obj=new google.maps.Map(this.map_el,this.map_options),this.map_clusterer=null,"function"==typeof MarkerClusterer&&(this.map_clusterer=new MarkerClusterer(this.map_obj)),this.map_style_manager=new EasyMapStyleManager({map:this.map_obj}),this.map_ext_src=new EasyExternalResource({map:this.map_obj}),this.map_geojson=new EasyGeoJSON({map:this.map_obj}),this.map_context=new EasyContextMenu({map:this.map_obj}),this.map_geocoder=new EasyGeoCoder({map:this.map_obj,geocoder:new google.maps.Geocoder}),this.allowed_map_bounds,this.max_zoom_level,this.min_zoom_level,this._attachMapEvents(),this.initInfoWindowSystem(),this.dragend_callback}function EasyMarker(t,e){this.latitude=t.latitude,this.longitude=t.longitude,this.title=null!=t.title?t.title:"",this.map=e.map_obj,this.icon=null!=t.icon?e.marker_res[t.icon]:"",this.marker=null,this.metadata=null,this.content=null,this.infoWindow=null,this.initMarker()}function EasyLine(t,e){this.strokeColor=t.stroke,this.strokeOpacity=t.opacity,this.strokeWeight=t.weight,this.map=e.map_obj,this.route=new google.maps.MVCArray,this.polyline=new google.maps.Polyline({path:this.route,strokeColor:this.strokeColor,strokeWeight:this.strokeWeight,strokeOpacity:this.strokeOpacity}),this.setMap(this.map)}function EasyLineProperties(t){this.strokeColor=null!=t.stroke?t.stroke:"#FF0000",this.strokeOpacity=null!=t.opacity?t.opacity:1,this.strokeWeight=null!=t.weight?t.weight:5}function EasyContextMenu(t){this.className=null!=t.className?t.className:"visibility: hidden; background: #ffffff; border: 1px solid #8888FF; z-index: 10; position: relative; width: 100px; height: 100px; padding: 5px;",this.innerHTML=null!=t.innerHTML?t.innerHTML:"",this.map=t.map,this.menuDiv,this.setMap(this.map)}function EasyGeoJSON(t){this.map=t.map,this.featureArr}function EasyExternalResource(t){this.resources={},this.map=t.map}function EasyMapStyleManager(t){this.styledMaps={},this.map=t.map}function EasyShape(t,e){this.map=e.map_obj,this.points=t.points,this.polygon=new google.maps.Polygon({paths:this.points}),this.setMap(this.map)}function EasyGeoCoder(t){this.map=t.map,this.geocoder=t.geocoder}function EasyGeoCoderData(t){this.raw_data=t}EasyMap.prototype={constructor:EasyMap,initInfoWindowSystem:function(){this.info_window_system==EasyMap.InfoWindowSystem.ONE_WINDOW&&(this.infoWindow=new google.maps.InfoWindow({content:"placeholder"}))},getCenter:function(){return this.map_obj.getCenter()},setCenter:function(t,e){this.map_obj.setCenter(new google.maps.LatLng(t,e))},getZoom:function(){return this.map_obj.getZoom()},setZoom:function(t){this.map_obj.setZoom(t)},getBounds:function(){return this.map_obj.getBounds()},changeToRoadmap:function(){this.map_obj.setMapTypeId(google.maps.MapTypeId.google.maps.MapTypeId.ROADMAP),this.current_maptypeid=google.maps.MapTypeId.google.maps.MapTypeId.ROADMAP},changeToSatellite:function(){this.map_obj.setMapTypeId(google.maps.MapTypeId.SATELLITE),this.current_maptypeid=google.maps.MapTypeId.SATELLITE},addMarker:function(t){var e=this,o=new EasyMarker(t,this);google.maps.event.addListener(o.marker,"click",function(){e.marker_callback(o)}),this.map_markers.push(o),o.setMetadata(t.metadata);var s=this.infoWindow;return this.info_window_system==EasyMap.InfoWindowSystem.MULTIPLE_WINDOW&&(s=new google.maps.InfoWindow({content:"placeholder"})),o.setInfoWindow(s),o},clearAllMarkers:function(){for(var t=0;t<this.map_markers.length;t++)this.map_markers[t].destroy();this.map_markers=[]},addMarkerRes:function(t,e){this.marker_res[t]=e},setMarkerRes:function(t){this.marker_res=t},setMarkersCallbackFunc:function(t){this.marker_callback=t},getMarkersCallbackFunc:function(){return this.marker_callback},cluster:function(){for(var t=[],e=0;e<this.map_markers.length;e++)t.push(this.map_markers[e].marker);this.map_clusterer.addMarkers(t)},decluster:function(){var t=this.map_clusterer.getMarkers();this.map_clusterer.clearMarkers();for(var e=0;e<t.length;e++)t[e].setMap(this.map_obj)},newLine:function(){this.map_lines.push(new EasyLine(this.default_line_props.makeConfig(),this))},getCurrentLine:function(){return this.map_lines[this.map_lines.length-1]},newPolygon:function(t){this.map_shapes.push(new EasyShape({points:t},this))},getStyleManager:function(){return this.map_style_manager},getExtResourceManager:function(){return this.map_ext_src},loadGeoJSON:function(t,e){var o=this;$.getJSON(t,function(t){o.map_geojson.addGeoJSON(t),e()})},addSyncMap:function(t){this.synced_maps.push(t)},removeSyncMap:function(t){var e=this.synced_maps.indexOf(t);-1!=e&&this.synced_maps.splice(e,1)},setBounds:function(t){t.enable?(this.max_zoom_level=null!=t.maxZoom?t.maxZoom:20,this.min_zoom_level=null!=t.minZoom?t.minZoom:0,null!=t.bounds&&(this.allowed_map_bounds=new google.maps.LatLngBounds(new google.maps.LatLng(t.bounds[0][0],t.bounds[0][1]),new google.maps.LatLng(t.bounds[1][0],t.bounds[1][1])))):(this.allowed_map_bounds=null,this.max_zoom_level=20)},setLogo:function(t){this.removeLogo(),this.logo_div=document.createElement("div"),this.logo_img=document.createElement("img"),this.logo_img.src=t,this.logo_img.id="CompanyLogo",this.logo_div.appendChild(this.logo_img),this.map_obj.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(this.logo_div)},removeLogo:function(){null!=this.logo_div&&this.map_obj.controls[google.maps.ControlPosition.LEFT_BOTTOM].pop()},showCoordinates:function(){this.coordinates_shown||(this.coordinates_shown=!0,this.map_obj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(this.coordinates_div))},hideCoordinates:function(){this.coordinates_shown&&(this.coordinates_shown=!1,this.map_obj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].pop())},setOnUserPosition:function(t,e){var o=this,s=null!=t?t:15,n=e;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var e=t.coords.latitude,a=t.coords.longitude,i=new google.maps.LatLng(e,a);o.map_obj.setCenter(i),o.map_obj.setZoom(s),null!=n&&n(i)})},reverseGeoCode:function(t,e){this.map_geocoder.reverseGeoCode(t,e)},onDragEnd:function(t){this.dragend_callback=t},_attachMapEvents:function(){var t=this;google.maps.event.addListener(this.map_obj,"drag",function(){t._mapDrag()}),google.maps.event.addListener(this.map_obj,"zoom_changed",function(){t._mapZoom()}),google.maps.event.addListener(this.map_obj,"click",function(){}),google.maps.event.addListener(this.map_obj,"rightclick",function(e){t._mapRightClick(e)}),google.maps.event.addListener(this.map_obj,"mousemove",function(e){t._mapMouseMove(e)}),google.maps.event.addListener(this.map_obj,"dragend",function(e){t._mapDragEnd(e)})},_mapDragEnd:function(t){null!=this.dragend_callback&&this.dragend_callback(t)},_mapRightClick:function(t){null!=this.map_context.getClass()&&null!=this.map_context.getHTML()&&this.map_context.show(t.latLng)},_mapDrag:function(){this._checkBounds();for(var t=0;t<this.synced_maps.length;t++)this.synced_maps[t].setCenter(this.map_obj.getCenter())},_mapZoom:function(){this._checkBounds();for(var t=0;t<this.synced_maps.length;t++)this.synced_maps[t].setZoom(this.map_obj.getZoom())},_mapMouseMove:function(t){if(this.coordinates_shown){var e="Lat/Lng: "+t.latLng.lat().toFixed(6)+" / "+t.latLng.lng().toFixed(6);this.coordinates_div.innerHTML=e}for(var o=0;o<this.synced_maps.length;o++)this.synced_maps[o]._mapMouseMove(t)},_checkBounds:function(){if(this.map_obj.getZoom()>this.max_zoom_level?this.map_obj.setZoom(this.max_zoom_level):this.map_obj.getZoom()<this.min_zoom_level&&this.map_obj.setZoom(this.min_zoom_level),null!=this.allowed_map_bounds&&!this.allowed_map_bounds.contains(this.map_obj.getCenter())){var t=this.map_obj.getCenter(),e=t.lng(),o=t.lat(),s=this.allowed_map_bounds.getNorthEast().lng(),n=this.allowed_map_bounds.getNorthEast().lat(),a=this.allowed_map_bounds.getSouthWest().lng(),i=this.allowed_map_bounds.getSouthWest().lat();a>e&&(e=a),e>s&&(e=s),i>o&&(o=i),o>n&&(o=n),this.map_obj.setCenter(new google.maps.LatLng(o,e))}}},EasyMap.InfoWindowSystem={NONE_WINDOW:0,ONE_WINDOW:1,MULTIPLE_WINDOW:2},EasyMarker.prototype={constructor:EasyMarker,initMarker:function(){this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.latitude,this.longitude),map:this.map,title:this.title,icon:this.icon})},setMetadata:function(t){this.metadata=t},getMetadata:function(){return this.metadata},setInfoContent:function(t){this.content=t},getInfoContent:function(){return this.content},setInfoWindow:function(t){this.infoWindow=t},showInfoWindow:function(t){null!=t&&(this.content=t),this.infoWindow.setContent(this.getInfoContent()),this.infoWindow.open(this.map,this.marker)},hide:function(){this.marker.setMap(null)},destroy:function(){this.hide()}},EasyLine.prototype={constructor:EasyLine,setMap:function(t){this.map=t,this.polyline.setMap(this.map)},addPoint:function(t,e){this.route.push(new google.maps.LatLng(t,e))}},EasyLineProperties.prototype={constructor:EasyLineProperties,setDefaultStroke:function(t){this.strokeColor=t},getDefaultStroke:function(){return this.strokeColor},setDefaultOpacity:function(t){this.strokeOpacity=t},getDefaultOpacity:function(){return this.strokeOpacity},setDefaultWeight:function(t){this.strokeWeight=t},getDefaultWeight:function(){return this.strokeWeight},makeConfig:function(){return{stroke:this.strokeColor,opacity:this.strokeOpacity,weight:this.strokeWeight}}},EasyContextMenu.prototype=new google.maps.OverlayView,EasyContextMenu.prototype.draw=function(){},EasyContextMenu.prototype.onAdd=function(){var t=this;this.menuDiv=document.createElement("div"),this.menuDiv.setAttribute("style",this.className),this.menuDiv.innerHTML=this.innerHTML,this.getPanes().floatPane.appendChild(this.menuDiv),google.maps.event.addListener(this.map,"click",function(){t.hide()})},EasyContextMenu.prototype.onRemove=function(){this.menuDiv.parentNode.removeChild(this.menuDiv)},EasyContextMenu.prototype.show=function(t){var e=this.getProjection(),o=e.fromLatLngToDivPixel(t),s=Math.floor(o.x),n=Math.floor(o.y);this.menuDiv.style.display="block",this.menuDiv.style.left=s+"px",this.menuDiv.style.top=n+"px",this.menuDiv.style.visibility="visible"},EasyContextMenu.prototype.hide=function(){this.menuDiv.style.visibility="hidden"},EasyContextMenu.prototype.setClass=function(t){this.className=t},EasyContextMenu.prototype.setHTML=function(t){this.innerHTML=t},EasyContextMenu.prototype.getClass=function(){return this.className},EasyContextMenu.prototype.getHTML=function(){return this.innerHTML},EasyGeoJSON.prototype={constructor:EasyGeoJSON,loadGeoJSON:function(t){this.map.data.loadGeoJson(t)},addGeoJSON:function(t){this.featureArr=this.map.data.addGeoJson(t)},changeStyleByProperty:function(t,e,o){for(var s=this.searchMatchFeatures(t,e),n=0;n<s.length;n++)this.map.data.overrideStyle(s[n],o)},searchMatchFeatures:function(t,e){for(var o=[],s=0;s<this.featureArr.length;s++){var n=this.featureArr[s];n.getProperty(t)==e&&o.push(n)}return o}},EasyExternalResource.prototype={constructor:EasyExternalResource,addSource:function(t){this.resources[t.name]=new google.maps.KmlLayer(t.url)},setSource:function(t){var e=this.resources[t];e.setMap(this.map)}},EasyMapStyleManager.prototype={constructor:EasyMapStyleManager,addStyleMap:function(t){var e=new google.maps.StyledMapType(t.style);this.styledMaps[t.name]=e,this.updateMapTypeIds()},addImageMap:function(t){var e=null;e=null!=t.tileSize?new google.maps.Size(t.tileSize[0],t.tileSize[1]):new google.maps.Size(256,256);var o=new google.maps.ImageMapType({getTileUrl:function(e,o){return t.callback(e,o)},tileSize:e,name:null!=t.title?t.title:"",maxZoom:null!=t.maxZoom?t.maxZoom:18,opacity:null!=t.opacity?t.opacity:1});this.styledMaps[t.name]=o,this.updateMapTypeIds()},updateMapTypeIds:function(){var t=this.makeMapTypeIds();this.map.setOptions({mapTypeControlOptions:{mapTypeIds:t}});for(var e=1;e<t.length;e++){var o=t[e],s=this.styledMaps[o];this.map.mapTypes.set(o,s)}},makeMapTypeIds:function(){var t=[];t.push(this.map.current_maptypeid);for(var e in this.styledMaps)this.styledMaps.hasOwnProperty(e)&&t.push(e);return t},setOverlay:function(t,e){this.map.overlayMapTypes.insertAt(t,this.styledMaps[e])}},EasyShape.prototype={constructor:EasyShape,setMap:function(t){this.map=t,this.polygon.setMap(this.map)}},EasyGeoCoder.prototype={constructor:EasyGeoCoder,reverseGeoCode:function(t,e){var o=new google.maps.LatLng(t[0],t[1]),s=e,n=this;this.geocoder.geocode({latLng:o},function(t){var e=n.makeGeoCoderData(t);s(e)})},makeGeoCoderData:function(t){var e=new EasyGeoCoderData(t);return e}},EasyGeoCoderData.prototype={constructor:EasyGeoCoderData,getCountry:function(){var t=this._parseAddressComp("country",!0);return t},getCity:function(){var t=this._parseAddressComp("locality",!0);return t},_parseAddressComp:function(t,e){for(var o=null,s=0;s<this.raw_data[0].address_components.length;s++)if(this.raw_data[0].address_components[s].types[0]==t){o=e?this.raw_data[0].address_components[s].long_name:this.raw_data[0].address_components[s].short_name;break}return o}};