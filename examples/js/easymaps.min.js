function EasyContextMenu(e){this.className=e.className!=null?e.className:"visibility: hidden; background: #ffffff; border: 1px solid #8888FF; z-index: 10; position: relative; width: 100px; height: 100px; padding: 5px;";this.innerHTML=e.innerHTML!=null?e.innerHTML:"";this.map=e.map;this.menuDiv;this.setMap(this.map)}function EasyGeoJSON(e){this.map=e.map;this.featureArr}function EasyLineProperties(e){this.strokeColor=e.stroke!=null?e.stroke:"#FF0000";this.strokeOpacity=e.opacity!=null?e.opacity:1;this.strokeWeight=e.weight!=null?e.weight:5}function EasyLine(e,t){this.strokeColor=e.stroke;this.strokeOpacity=e.opacity;this.strokeWeight=e.weight;this.map=t.map_obj;this.route=new google.maps.MVCArray;this.polyline=new google.maps.Polyline({path:this.route,strokeColor:this.strokeColor,strokeWeight:this.strokeWeight,strokeOpacity:this.strokeOpacity});this.setMap(this.map)}function EasyMap(e){this.map_el=document.getElementById(e.container);this.map_obj=null;this.info_window_system=e.infoWindowSystem!=null?e.infoWindowSystem:EasyMap.InfoWindowSystem.ONE_WINDOW;this.map_markers=[];this.map_lines=[];this.map_shapes=[];this.marker_res={};this.synced_maps=[];this.logo_div;this.logo_img;this.coordinates_div=document.createElement("div");this.coordinates_div.setAttribute("style","width: 200px; height: 20px; background-color: #FFFFFF; border-style: solid; border-width: 1px; padding: 2px 5px;");this.coordinates_div.innerHTML="Lat/Lng: 0.00 / 0.00";this.coordinates_shown=false;this.default_line_props=new EasyLineProperties({});this.current_maptypeid=e.mapTypeId!=null?e.mapTypeId:google.maps.MapTypeId.ROADMAP;this.infoWindow=null;this.marker_callback=null;this.map_options={center:new google.maps.LatLng(e.latitude,e.longitude),zoom:e.zoom!=null?e.zoom:15,mapTypeId:this.current_maptypeid};this.map_obj=new google.maps.Map(this.map_el,this.map_options);this.map_clusterer=null;if(typeof MarkerClusterer=="function"){this.map_clusterer=new MarkerClusterer(this.map_obj)}this.map_style_manager=new EasyMapStyleManager({map:this.map_obj});this.map_ext_src=new EasyExternalResource({map:this.map_obj});this.map_geojson=new EasyGeoJSON({map:this.map_obj});this.map_context=new EasyContextMenu({map:this.map_obj});this.allowed_map_bounds;this.max_zoom_level;this.min_zoom_level;this._attachMapEvents();this.initInfoWindowSystem()}function EasyExternalResource(e){this.resources={};this.map=e.map}function EasyMapStyleManager(e){this.styledMaps={};this.map=e.map}function EasyMarker(e,t){this.latitude=e.latitude;this.longitude=e.longitude;this.title=e.title!=null?e.title:"";this.map=t.map_obj;this.icon=e.icon!=null?t.marker_res[e.icon]:"";this.marker=null;this.metadata=null;this.content=null;this.infoWindow=null;this.initMarker()}function EasyShape(e,t){this.map=t.map_obj;this.points=e.points;this.polygon=new google.maps.Polygon({paths:this.points});this.setMap(this.map)}EasyContextMenu.prototype=new google.maps.OverlayView;EasyContextMenu.prototype.draw=function(){};EasyContextMenu.prototype.onAdd=function(){var e=this;this.menuDiv=document.createElement("div");this.menuDiv.setAttribute("style",this.className);this.menuDiv.innerHTML=this.innerHTML;this.getPanes().floatPane.appendChild(this.menuDiv);google.maps.event.addListener(this.map,"click",function(t){e.hide()})};EasyContextMenu.prototype.onRemove=function(){this.menuDiv.parentNode.removeChild(this.menuDiv)};EasyContextMenu.prototype.show=function(e){var t=this.getProjection();var n=t.fromLatLngToDivPixel(e);var r=Math.floor(n.x);var i=Math.floor(n.y);this.menuDiv.style.display="block";this.menuDiv.style.left=r+"px";this.menuDiv.style.top=i+"px";this.menuDiv.style.visibility="visible"};EasyContextMenu.prototype.hide=function(){this.menuDiv.style.visibility="hidden"};EasyContextMenu.prototype.setClass=function(e){this.className=e};EasyContextMenu.prototype.setHTML=function(e){this.innerHTML=e};EasyContextMenu.prototype.getClass=function(e){return this.className};EasyContextMenu.prototype.getHTML=function(e){return this.innerHTML};EasyGeoJSON.prototype={constructor:EasyGeoJSON,loadGeoJSON:function(e){this.map.data.loadGeoJson(e)},addGeoJSON:function(e){this.featureArr=this.map.data.addGeoJson(e)},changeStyleByProperty:function(e,t,n){var r=this.searchMatchFeatures(e,t);for(var i=0;i<r.length;i++){this.map.data.overrideStyle(r[i],n)}},searchMatchFeatures:function(e,t){var n=[];for(var r=0;r<this.featureArr.length;r++){var i=this.featureArr[r];if(i.getProperty(e)==t){n.push(i)}}return n}};EasyLineProperties.prototype={constructor:EasyLineProperties,setDefaultStroke:function(e){this.strokeColor=e},getDefaultStroke:function(){return this.strokeColor},setDefaultOpacity:function(e){this.strokeOpacity=e},getDefaultOpacity:function(){return this.strokeOpacity},setDefaultWeight:function(e){this.strokeWeight=e},getDefaultWeight:function(){return this.strokeWeight},makeConfig:function(){return{stroke:this.strokeColor,opacity:this.strokeOpacity,weight:this.strokeWeight}}};EasyLine.prototype={constructor:EasyLine,setMap:function(e){this.map=e;this.polyline.setMap(this.map)},addPoint:function(e,t){this.route.push(new google.maps.LatLng(e,t))}};EasyMap.prototype={constructor:EasyMap,initInfoWindowSystem:function(){if(this.info_window_system==EasyMap.InfoWindowSystem.ONE_WINDOW){this.infoWindow=new google.maps.InfoWindow({content:"placeholder"})}},getCenter:function(){return this.map_obj.getCenter()},setCenter:function(e,t){this.map_obj.setCenter(new google.maps.LatLng(e,t))},getZoom:function(){return this.map_obj.getZoom()},setZoom:function(e){this.map_obj.setZoom(e)},changeToRoadmap:function(){this.map_obj.setMapTypeId(google.maps.MapTypeId.google.maps.MapTypeId.ROADMAP);this.current_maptypeid=google.maps.MapTypeId.google.maps.MapTypeId.ROADMAP},changeToSatellite:function(){this.map_obj.setMapTypeId(google.maps.MapTypeId.SATELLITE);this.current_maptypeid=google.maps.MapTypeId.SATELLITE},addMarker:function(e){var t=this;var n=new EasyMarker(e,this);google.maps.event.addListener(n.marker,"click",function(){t.marker_callback(n)});this.map_markers.push(n);n.setMetadata(e.metadata);var r=this.infoWindow;if(this.info_window_system==EasyMap.InfoWindowSystem.MULTIPLE_WINDOW){r=new google.maps.InfoWindow({content:"placeholder"})}n.setInfoWindow(r);return n},clearAllMarkers:function(){for(var e=0;e<this.map_markers.length;e++){this.map_markers[e].destroy()}this.map_markers=[]},addMarkerRes:function(e,t){this.marker_res[e]=t},setMarkerRes:function(e){this.marker_res=e},setMarkersCallbackFunc:function(e){this.marker_callback=e},getMarkersCallbackFunc:function(){return this.marker_callback},cluster:function(){var e=[];for(var t=0;t<this.map_markers.length;t++){e.push(this.map_markers[t].marker)}this.map_clusterer.addMarkers(e)},decluster:function(){var e=this.map_clusterer.getMarkers();this.map_clusterer.clearMarkers();for(var t=0;t<e.length;t++){e[t].setMap(this.map_obj)}},newLine:function(){this.map_lines.push(new EasyLine(this.default_line_props.makeConfig(),this))},getCurrentLine:function(){return this.map_lines[this.map_lines.length-1]},newPolygon:function(e){this.map_shapes.push(new EasyShape({points:e},this))},getStyleManager:function(){return this.map_style_manager},getExtResourceManager:function(){return this.map_ext_src},loadGeoJSON:function(e,t){var n=this;$.getJSON(e,function(e){n.map_geojson.addGeoJSON(e);t()})},addSyncMap:function(e){this.synced_maps.push(e)},removeSyncMap:function(e){var t=this.synced_maps.indexOf(e);if(t!=-1){this.synced_maps.splice(t,1)}},setBounds:function(e){if(!e.enable){this.allowed_map_bounds=null;this.max_zoom_level=20}else{this.max_zoom_level=e.maxZoom!=null?e.maxZoom:20;this.min_zoom_level=e.minZoom!=null?e.minZoom:0;if(e.bounds!=null){this.allowed_map_bounds=new google.maps.LatLngBounds(new google.maps.LatLng(e.bounds[0][0],e.bounds[0][1]),new google.maps.LatLng(e.bounds[1][0],e.bounds[1][1]))}}},setLogo:function(e){this.removeLogo();this.logo_div=document.createElement("div");this.logo_img=document.createElement("img");this.logo_img.src=e;this.logo_img.id="CompanyLogo";this.logo_div.appendChild(this.logo_img);this.map_obj.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(this.logo_div)},removeLogo:function(){if(this.logo_div!=null){this.map_obj.controls[google.maps.ControlPosition.LEFT_BOTTOM].pop()}},showCoordinates:function(){if(!this.coordinates_shown){this.coordinates_shown=true;this.map_obj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(this.coordinates_div)}},hideCoordinates:function(){if(this.coordinates_shown){this.coordinates_shown=false;this.map_obj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].pop()}},setOnUserPosition:function(e,t){var n=this;var r=e!=null?e:15;var i=t;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){var t=e.coords.latitude;var s=e.coords.longitude;var o=new google.maps.LatLng(t,s);n.map_obj.setCenter(o);n.map_obj.setZoom(r);if(i!=null){i()}})}},_attachMapEvents:function(){var e=this;google.maps.event.addListener(this.map_obj,"drag",function(){e._mapDrag()});google.maps.event.addListener(this.map_obj,"zoom_changed",function(){e._mapZoom()});google.maps.event.addListener(this.map_obj,"click",function(e){});google.maps.event.addListener(this.map_obj,"rightclick",function(t){e._mapRightClick(t)});google.maps.event.addListener(this.map_obj,"mousemove",function(t){e._mapMouseMove(t)})},_mapRightClick:function(e){if(this.map_context.getClass()!=null&&this.map_context.getHTML()!=null){this.map_context.show(e.latLng)}},_mapDrag:function(){this._checkBounds();for(var e=0;e<this.synced_maps.length;e++){this.synced_maps[e].setCenter(this.map_obj.getCenter())}},_mapZoom:function(){this._checkBounds();for(var e=0;e<this.synced_maps.length;e++){this.synced_maps[e].setZoom(this.map_obj.getZoom())}},_mapMouseMove:function(e){if(this.coordinates_shown){var t="Lat/Lng: "+e.latLng.lat().toFixed(6)+" / "+e.latLng.lng().toFixed(6);this.coordinates_div.innerHTML=t}for(var n=0;n<this.synced_maps.length;n++){this.synced_maps[n]._mapMouseMove(e)}},_checkBounds:function(){if(this.map_obj.getZoom()>this.max_zoom_level){this.map_obj.setZoom(this.max_zoom_level)}else if(this.map_obj.getZoom()<this.min_zoom_level){this.map_obj.setZoom(this.min_zoom_level)}if(this.allowed_map_bounds!=null){if(!this.allowed_map_bounds.contains(this.map_obj.getCenter())){var e=this.map_obj.getCenter();var t=e.lng();var n=e.lat();var r=this.allowed_map_bounds.getNorthEast().lng();var i=this.allowed_map_bounds.getNorthEast().lat();var s=this.allowed_map_bounds.getSouthWest().lng();var o=this.allowed_map_bounds.getSouthWest().lat();if(t<s){t=s}if(t>r){t=r}if(n<o){n=o}if(n>i){n=i}this.map_obj.setCenter(new google.maps.LatLng(n,t))}}}};EasyMap.InfoWindowSystem={NONE_WINDOW:0,ONE_WINDOW:1,MULTIPLE_WINDOW:2};EasyExternalResource.prototype={constructor:EasyExternalResource,addSource:function(e){this.resources[e.name]=new google.maps.KmlLayer(e.url)},setSource:function(e){var t=this.resources[e];t.setMap(this.map)}};EasyMapStyleManager.prototype={constructor:EasyMapStyleManager,addStyleMap:function(e){var t=new google.maps.StyledMapType(e.style);this.styledMaps[e.name]=t;this.updateMapTypeIds()},addImageMap:function(e){var t=null;if(e.tileSize!=null){t=new google.maps.Size(e.tileSize[0],e.tileSize[1])}else{t=new google.maps.Size(256,256)}var n=new google.maps.ImageMapType({getTileUrl:function(t,n){return e.callback(t,n)},tileSize:t,name:e.title!=null?e.title:"",maxZoom:e.maxZoom!=null?e.maxZoom:18,opacity:e.opacity!=null?e.opacity:1});this.styledMaps[e.name]=n;this.updateMapTypeIds()},updateMapTypeIds:function(){var e=this.makeMapTypeIds();this.map.setOptions({mapTypeControlOptions:{mapTypeIds:e}});for(var t=1;t<e.length;t++){var n=e[t];var r=this.styledMaps[n];this.map.mapTypes.set(n,r)}},makeMapTypeIds:function(){var e=[];e.push(this.map.current_maptypeid);for(var t in this.styledMaps){if(this.styledMaps.hasOwnProperty(t)){e.push(t)}}return e},setOverlay:function(e,t){this.map.overlayMapTypes.insertAt(e,this.styledMaps[t])}};EasyMarker.prototype={constructor:EasyMarker,initMarker:function(){this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.latitude,this.longitude),map:this.map,title:this.title,icon:this.icon})},setMetadata:function(e){this.metadata=e},getMetadata:function(){return this.metadata},setInfoContent:function(e){this.content=e},getInfoContent:function(){return this.content},setInfoWindow:function(e){this.infoWindow=e},showInfoWindow:function(e){if(e!=null){this.content=e}this.infoWindow.setContent(this.getInfoContent());this.infoWindow.open(this.map,this.marker)},hide:function(){this.marker.setMap(null)},destroy:function(){this.hide()}};EasyShape.prototype={constructor:EasyShape,setMap:function(e){this.map=e;this.polygon.setMap(this.map)}}