function EasyContextMenu(t){this.className=t.className!=null?t.className:"visibility: hidden; background: #ffffff; border: 1px solid #8888FF; z-index: 10; position: relative; width: 100px; height: 100px; padding: 5px;";this.innerHTML=t.innerHTML!=null?t.innerHTML:"";this.map=t.map;this.menuDiv;this.setMap(this.map)}EasyContextMenu.prototype=new google.maps.OverlayView;EasyContextMenu.prototype.draw=function(){};EasyContextMenu.prototype.onAdd=function(){var t=this;this.menuDiv=document.createElement("div");this.menuDiv.setAttribute("style",this.className);this.menuDiv.innerHTML=this.innerHTML;this.getPanes().floatPane.appendChild(this.menuDiv);google.maps.event.addListener(this.map,"click",function(e){t.hide()})};EasyContextMenu.prototype.onRemove=function(){this.menuDiv.parentNode.removeChild(this.menuDiv)};EasyContextMenu.prototype.show=function(t){var e=this.getProjection();var s=e.fromLatLngToDivPixel(t);var o=Math.floor(s.x);var a=Math.floor(s.y);this.menuDiv.style.display="block";this.menuDiv.style.left=o+"px";this.menuDiv.style.top=a+"px";this.menuDiv.style.visibility="visible"};EasyContextMenu.prototype.hide=function(){this.menuDiv.style.visibility="hidden"};EasyContextMenu.prototype.setClass=function(t){this.className=t};EasyContextMenu.prototype.setHTML=function(t){this.innerHTML=t};EasyContextMenu.prototype.getClass=function(t){return this.className};EasyContextMenu.prototype.getHTML=function(t){return this.innerHTML};function EasyGeoCoder(t){this.map=t.map;this.geocoder=t.geocoder}EasyGeoCoder.prototype={constructor:EasyGeoCoder,reverseGeoCode:function(t,e){var s=new google.maps.LatLng(t[0],t[1]);var o=e;var a=this;this.geocoder.geocode({latLng:s},function(t,e){var s=a.makeGeoCoderData(t);o(s)})},makeGeoCoderData:function(t){var e=new EasyGeoCoderData(t);return e}};function EasyGeoCoderData(t){this.raw_data=t}EasyGeoCoderData.prototype={constructor:EasyGeoCoderData,getCountry:function(){var t=this._parseAddressComp("country",true);return t},getCity:function(){var t=this._parseAddressComp("locality",true);return t},_parseAddressComp:function(t,e){var s=null;for(var o=0;o<this.raw_data[0].address_components.length;o++){if(this.raw_data[0].address_components[o].types[0]==t){if(e){s=this.raw_data[0].address_components[o].long_name}else{s=this.raw_data[0].address_components[o].short_name}break}}return s}};function EasyGeoJSON(t){this.map=t.map;this.featureArr}EasyGeoJSON.prototype={constructor:EasyGeoJSON,loadGeoJSON:function(t){this.map.data.loadGeoJson(t)},addGeoJSON:function(t){this.featureArr=this.map.data.addGeoJson(t)},changeStyleByProperty:function(t,e,s){var o=this.searchMatchFeatures(t,e);for(var a=0;a<o.length;a++){this.map.data.overrideStyle(o[a],s)}},searchMatchFeatures:function(t,e){var s=[];for(var o=0;o<this.featureArr.length;o++){var a=this.featureArr[o];if(a.getProperty(t)==e){s.push(a)}}return s}};function EasyLine(t,e){this.strokeColor=t.stroke;this.strokeOpacity=t.opacity;this.strokeWeight=t.weight;this.map=e.map_obj;this.route=new google.maps.MVCArray;this.polyline=new google.maps.Polyline({path:this.route,strokeColor:this.strokeColor,strokeWeight:this.strokeWeight,strokeOpacity:this.strokeOpacity});this.setMap(this.map)}EasyLine.prototype={constructor:EasyLine,setMap:function(t){this.map=t;this.polyline.setMap(this.map)},addPoint:function(t,e){this.route.push(new google.maps.LatLng(t,e))}};function EasyLineProperties(t){this.strokeColor=t.stroke!=null?t.stroke:"#FF0000";this.strokeOpacity=t.opacity!=null?t.opacity:1;this.strokeWeight=t.weight!=null?t.weight:5}EasyLineProperties.prototype={constructor:EasyLineProperties,setDefaultStroke:function(t){this.strokeColor=t},getDefaultStroke:function(){return this.strokeColor},setDefaultOpacity:function(t){this.strokeOpacity=t},getDefaultOpacity:function(){return this.strokeOpacity},setDefaultWeight:function(t){this.strokeWeight=t},getDefaultWeight:function(){return this.strokeWeight},makeConfig:function(){return{stroke:this.strokeColor,opacity:this.strokeOpacity,weight:this.strokeWeight}}};function EasyMap(t){this.map_el=document.getElementById(t.container);this.map_obj=null;this.info_window_system=t.infoWindowSystem!=null?t.infoWindowSystem:EasyMap.InfoWindowSystem.ONE_WINDOW;this.map_markers=[];this.master_markers=[];this.map_lines=[];this.map_shapes=[];this.marker_res={};this.synced_maps=[];this.cluster_by_marker=t.clusterMarkers!=null?t.clusterMarkers:false;this.logo_div;this.logo_img;this.coordinates_div=document.createElement("div");this.coordinates_div.setAttribute("style","width: 200px; height: 20px; background-color: #FFFFFF; border-style: solid; border-width: 1px; padding: 2px 5px;");this.coordinates_div.innerHTML="Lat/Lng: 0.00 / 0.00";this.coordinates_shown=false;this.default_line_props=new EasyLineProperties({});this.current_maptypeid=t.mapTypeId!=null?t.mapTypeId:google.maps.MapTypeId.ROADMAP;this.infoWindow=null;this.marker_callback=null;this.map_options={center:new google.maps.LatLng(t.latitude,t.longitude),zoom:t.zoom!=null?t.zoom:15,mapTypeId:this.current_maptypeid};this.map_obj=new google.maps.Map(this.map_el,this.map_options);this.map_clusterer=null;if(typeof MarkerClusterer=="function"){this.map_clusterer=new MarkerClusterer(this.map_obj)}this.map_style_manager=new EasyMapStyleManager({map:this.map_obj});this.map_ext_src=new EasyExternalResource({map:this.map_obj});this.map_geojson=new EasyGeoJSON({map:this.map_obj});this.map_context=new EasyContextMenu({map:this.map_obj});this.map_geocoder=new EasyGeoCoder({map:this.map_obj,geocoder:new google.maps.Geocoder});this.allowed_map_bounds;this.max_zoom_level;this.min_zoom_level;this._attachMapEvents();this.initInfoWindowSystem();this.dragend_callback}EasyMap.prototype={constructor:EasyMap,initInfoWindowSystem:function(){if(this.info_window_system==EasyMap.InfoWindowSystem.ONE_WINDOW){this.infoWindow=new google.maps.InfoWindow({content:"placeholder"})}},getCenter:function(){return this.map_obj.getCenter()},setCenter:function(t,e){this.map_obj.setCenter(new google.maps.LatLng(t,e))},getZoom:function(){return this.map_obj.getZoom()},setZoom:function(t){this.map_obj.setZoom(t)},getBounds:function(){return this.map_obj.getBounds()},changeToRoadmap:function(){this.map_obj.setMapTypeId(google.maps.MapTypeId.google.maps.MapTypeId.ROADMAP);this.current_maptypeid=google.maps.MapTypeId.google.maps.MapTypeId.ROADMAP},changeToSatellite:function(){this.map_obj.setMapTypeId(google.maps.MapTypeId.SATELLITE);this.current_maptypeid=google.maps.MapTypeId.SATELLITE},addMarker:function(t){var e=this;var s=new EasyMarker(t,this);google.maps.event.addListener(s.marker,"click",function(){e.marker_callback(s)});s.setMetadata(t.metadata);var o=this.infoWindow;if(this.info_window_system==EasyMap.InfoWindowSystem.MULTIPLE_WINDOW){o=new google.maps.InfoWindow({content:"placeholder"})}s.setInfoWindow(o);if(this.cluster_by_marker){var a=false;for(var i=0;i<this.master_markers.length;i++){if(this.master_markers[i].contains(s)){this.master_markers[i].addChildMarker(s);a=true;break}}if(!a){var n=1e-4;var r=new google.maps.LatLng(s.latitude-n,s.longitude-n);var h=new google.maps.LatLng(s.latitude+n,s.longitude+n);var l=new google.maps.LatLngBounds(r,h);var p=[];for(var i=0;i<this.map_markers.length;i++){if(l.contains(this.map_markers[i].marker.getPosition())){p.push(this.map_markers[i])}}if(p.length>0){var m=new EasyMarkerCluster({latitude:s.latitude,longitude:s.longitude},this);m.addChildMarker(s);for(var i=0;i<p.length;i++){m.addChildMarker(p[i])}}else{this.map_markers.push(s)}}}else{this.map_markers.push(s)}return s},clearAllMarkers:function(){for(var t=0;t<this.map_markers.length;t++){this.map_markers[t].destroy()}this.map_markers=[]},addMarkerRes:function(t,e){this.marker_res[t]=e},setMarkerRes:function(t){this.marker_res=t},setMarkersCallbackFunc:function(t){this.marker_callback=t},getMarkersCallbackFunc:function(){return this.marker_callback},cluster:function(){var t=[];for(var e=0;e<this.map_markers.length;e++){t.push(this.map_markers[e].marker)}this.map_clusterer.addMarkers(t)},decluster:function(){var t=this.map_clusterer.getMarkers();this.map_clusterer.clearMarkers();for(var e=0;e<t.length;e++){t[e].setMap(this.map_obj)}},newLine:function(){this.map_lines.push(new EasyLine(this.default_line_props.makeConfig(),this))},getCurrentLine:function(){return this.map_lines[this.map_lines.length-1]},newPolygon:function(t){this.map_shapes.push(new EasyShape({points:t},this))},getStyleManager:function(){return this.map_style_manager},getExtResourceManager:function(){return this.map_ext_src},loadGeoJSON:function(t,e){var s=this;$.getJSON(t,function(t){s.map_geojson.addGeoJSON(t);e()})},addSyncMap:function(t){this.synced_maps.push(t)},removeSyncMap:function(t){var e=this.synced_maps.indexOf(t);if(e!=-1){this.synced_maps.splice(e,1)}},setBounds:function(t){if(!t.enable){this.allowed_map_bounds=null;this.max_zoom_level=20}else{this.max_zoom_level=t.maxZoom!=null?t.maxZoom:20;this.min_zoom_level=t.minZoom!=null?t.minZoom:0;if(t.bounds!=null){this.allowed_map_bounds=new google.maps.LatLngBounds(new google.maps.LatLng(t.bounds[0][0],t.bounds[0][1]),new google.maps.LatLng(t.bounds[1][0],t.bounds[1][1]))}}},setLogo:function(t){this.removeLogo();this.logo_div=document.createElement("div");this.logo_img=document.createElement("img");this.logo_img.src=t;this.logo_img.id="CompanyLogo";this.logo_div.appendChild(this.logo_img);this.map_obj.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(this.logo_div)},removeLogo:function(){if(this.logo_div!=null){this.map_obj.controls[google.maps.ControlPosition.LEFT_BOTTOM].pop()}},showCoordinates:function(){if(!this.coordinates_shown){this.coordinates_shown=true;this.map_obj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(this.coordinates_div)}},hideCoordinates:function(){if(this.coordinates_shown){this.coordinates_shown=false;this.map_obj.controls[google.maps.ControlPosition.RIGHT_BOTTOM].pop()}},setOnUserPosition:function(t,e){var s=this;var o=t!=null?t:15;var a=e;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(t){var e=t.coords.latitude;var i=t.coords.longitude;var n=new google.maps.LatLng(e,i);s.map_obj.setCenter(n);s.map_obj.setZoom(o);if(a!=null){a(n)}})}},reverseGeoCode:function(t,e){this.map_geocoder.reverseGeoCode(t,e)},onDragEnd:function(t){this.dragend_callback=t},_attachMapEvents:function(){var t=this;google.maps.event.addListener(this.map_obj,"drag",function(){t._mapDrag()});google.maps.event.addListener(this.map_obj,"zoom_changed",function(){t._mapZoom()});google.maps.event.addListener(this.map_obj,"click",function(t){});google.maps.event.addListener(this.map_obj,"rightclick",function(e){t._mapRightClick(e)});google.maps.event.addListener(this.map_obj,"mousemove",function(e){t._mapMouseMove(e)});google.maps.event.addListener(this.map_obj,"dragend",function(e){t._mapDragEnd(e)})},_mapDragEnd:function(t){if(this.dragend_callback!=null){this.dragend_callback(t)}},_mapRightClick:function(t){if(this.map_context.getClass()!=null&&this.map_context.getHTML()!=null){this.map_context.show(t.latLng)}},_mapDrag:function(){this._checkBounds();for(var t=0;t<this.synced_maps.length;t++){this.synced_maps[t].setCenter(this.map_obj.getCenter())}},_mapZoom:function(){this._checkBounds();for(var t=0;t<this.synced_maps.length;t++){this.synced_maps[t].setZoom(this.map_obj.getZoom())}},_mapMouseMove:function(t){if(this.coordinates_shown){var e="Lat/Lng: "+t.latLng.lat().toFixed(6)+" / "+t.latLng.lng().toFixed(6);this.coordinates_div.innerHTML=e}for(var s=0;s<this.synced_maps.length;s++){this.synced_maps[s]._mapMouseMove(t)}},_checkBounds:function(){if(this.map_obj.getZoom()>this.max_zoom_level){this.map_obj.setZoom(this.max_zoom_level)}else if(this.map_obj.getZoom()<this.min_zoom_level){this.map_obj.setZoom(this.min_zoom_level)}if(this.allowed_map_bounds!=null){if(!this.allowed_map_bounds.contains(this.map_obj.getCenter())){var t=this.map_obj.getCenter();var e=t.lng();var s=t.lat();var o=this.allowed_map_bounds.getNorthEast().lng();var a=this.allowed_map_bounds.getNorthEast().lat();var i=this.allowed_map_bounds.getSouthWest().lng();var n=this.allowed_map_bounds.getSouthWest().lat();if(e<i){e=i}if(e>o){e=o}if(s<n){s=n}if(s>a){s=a}this.map_obj.setCenter(new google.maps.LatLng(s,e))}}}};EasyMap.InfoWindowSystem={NONE_WINDOW:0,ONE_WINDOW:1,MULTIPLE_WINDOW:2};function EasyExternalResource(t){this.resources={};this.map=t.map}EasyExternalResource.prototype={constructor:EasyExternalResource,addSource:function(t){this.resources[t.name]=new google.maps.KmlLayer(t.url)},setSource:function(t){var e=this.resources[t];e.setMap(this.map)}};function EasyMapStyleManager(t){this.styledMaps={};this.map=t.map}EasyMapStyleManager.prototype={constructor:EasyMapStyleManager,addStyleMap:function(t){var e=new google.maps.StyledMapType(t.style);this.styledMaps[t.name]=e;this.updateMapTypeIds()},addImageMap:function(t){var e=null;if(t.tileSize!=null){e=new google.maps.Size(t.tileSize[0],t.tileSize[1])}else{e=new google.maps.Size(256,256)}var s=new google.maps.ImageMapType({getTileUrl:function(e,s){return t.callback(e,s)},tileSize:e,name:t.title!=null?t.title:"",maxZoom:t.maxZoom!=null?t.maxZoom:18,opacity:t.opacity!=null?t.opacity:1});this.styledMaps[t.name]=s;this.updateMapTypeIds()},updateMapTypeIds:function(){var t=this.makeMapTypeIds();this.map.setOptions({mapTypeControlOptions:{mapTypeIds:t}});for(var e=1;e<t.length;e++){var s=t[e];var o=this.styledMaps[s];this.map.mapTypes.set(s,o)}},makeMapTypeIds:function(){var t=[];t.push(this.map.current_maptypeid);for(var e in this.styledMaps){if(this.styledMaps.hasOwnProperty(e)){t.push(e)}}return t},setOverlay:function(t,e){this.map.overlayMapTypes.insertAt(t,this.styledMaps[e])}};function EasyMarker(t,e){this.latitude=t.latitude;this.longitude=t.longitude;this.real_latitude=t.latitude;this.real_longitude=t.longitude;this.title=t.title!=null?t.title:"";this.map=e.map_obj;this.icon=t.icon!=null?e.marker_res[t.icon]:"";this.marker=null;this.metadata=null;this.content=null;this.infoWindow=null;this.initMarker()}EasyMarker.prototype={constructor:EasyMarker,initMarker:function(){this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.latitude,this.longitude),map:this.map,title:this.title,icon:this.icon})},setMetadata:function(t){this.metadata=t},getMetadata:function(){return this.metadata},setInfoContent:function(t){this.content=t},getInfoContent:function(){return this.content},setInfoWindow:function(t){this.infoWindow=t},showInfoWindow:function(t){if(t!=null){this.content=t}this.infoWindow.setContent(this.getInfoContent());this.infoWindow.open(this.map,this.marker)},latLng:function(){var t={lat:this.real_latitude,lng:this.real_longitude}},updateChildPos:function(){this.marker.setPosition(new google.maps.LatLng(this.latitude,this.longitude))},show:function(){this.marker.setMap(this.map)},hide:function(){this.marker.setMap(null)},destroy:function(){this.hide()}};function EasyMarkerCluster(t,e){this.latitude=t.latitude;this.longitude=t.longitude;this.easy_markers=[];this.map=e;this.icon=t.icon!=null?e.marker_res[t.icon]:"";this.initMarker();this.bounds={lat:1e-4,lng:1e-4};this.k=1e-4;this.markers_hide=true;var s=new google.maps.LatLng(this.latitude-this.k,this.longitude-this.k);var o=new google.maps.LatLng(this.latitude+this.k,this.longitude+this.k);this.bounds=new google.maps.LatLngBounds(s,o)}EasyMarkerCluster.prototype={constructor:EasyMarkerCluster,initMarker:function(){this.marker=new google.maps.Marker({position:new google.maps.LatLng(this.latitude,this.longitude),map:this.map.map_obj,icon:this.icon});var t=this;google.maps.event.addListener(this.marker,"click",function(){if(t.markers_hide){t.showMarkers()}else{t.hideMarkers()}t.markers_hide=!t.markers_hide});this.map.master_markers.push(this)},addChildMarker:function(t){this.easy_markers.push(t);var e=360/this.easy_markers.length;var s=e;for(var o=0;o<this.easy_markers.length;o++){var a=s*(Math.PI/180);var i=.004*Math.sin(a);var n=.004*Math.cos(a);this.easy_markers[o].latitude=this.latitude+i;this.easy_markers[o].longitude=this.longitude+n;this.easy_markers[o].updateChildPos();this.easy_markers[o].hide();s+=e}},contains:function(t){if(this.bounds.contains(t.marker.getPosition())){return true}return false},showMarkers:function(){for(var t=0;t<this.easy_markers.length;t++){this.easy_markers[t].show()}},hideMarkers:function(){for(var t=0;t<this.easy_markers.length;t++){this.easy_markers[t].hide()}},hide:function(){this.marker.setMap(null)},destroy:function(){this.hide()}};function EasyShape(t,e){this.map=e.map_obj;this.points=t.points;this.polygon=new google.maps.Polygon({paths:this.points});this.setMap(this.map)}EasyShape.prototype={constructor:EasyShape,setMap:function(t){this.map=t;this.polygon.setMap(this.map)}};